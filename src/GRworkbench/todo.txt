Make both threads close on exit.

Throw exceptions, not strings.

